

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Arm Master Package &mdash; DE3-Panda-Wall 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Spawn Manager Package" href="spawn_doc.html" />
    <link rel="prev" title="Getting Started" href="getting_start.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> DE3-Panda-Wall
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="home.html">DE3 Robotics Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_start.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Arm Master Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#file-structure">File Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#main-control-loop">Main Control Loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="#real-panda">real_panda</a></li>
<li class="toctree-l2"><a class="reference internal" href="#loop">Loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="#behind-the-scenes">Behind the Scenes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pick-up">Pick Up</a></li>
<li class="toctree-l3"><a class="reference internal" href="#move-towards">Move towards</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="spawn_doc.html">Spawn Manager Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="gazebo_problems.html">Running on Gazebo</a></li>
<li class="toctree-l1"><a class="reference internal" href="real_panda.html">Running on Real Panda</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface.html">AR Interface for wall-building</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DE3-Panda-Wall</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Arm Master Package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/arm_master.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="arm-master-package">
<h1>Arm Master Package<a class="headerlink" href="#arm-master-package" title="Permalink to this headline">¶</a></h1>
<p><em>“I am the master of my fate: I am the captain of my soul.”</em></p>
<p><em>- William Ernest Henley</em></p>
<p>Arm Master is the <em>ROS Package</em> which controls the arm. At the most basic level, its purpose is to query goal
end effector poses, and then move the arm from the current position to meet the new goal.</p>
<p>Code for this computation is located in <em>python</em> scripts. Some of these scripts exposes them selves as ROS node, but their are also some scripts that simply
provide pure <em>python</em> function calls.</p>
<div class="section" id="file-structure">
<h2>File Structure<a class="headerlink" href="#file-structure" title="Permalink to this headline">¶</a></h2>
<p>The core of the package files are structure as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>arm_master
├── docs
└── launch
    ├── light.launch
    ├── panda_one_brick.launch
    └── sim.launch
└── scripts
    ├── arm_master_main.py
    ├── arm_master_functions.py
    ├── move_arm_server.py
    ├── arm_server_functions.py
    ├── arm_utils.py
    └── dropped_checker_server.launch
├── CMakeLists.txt
└── package.xml
</pre></div>
</div>
<p>Launch files <a class="reference external" href="https://github.com/de3-robo/arm_master/blob/master/scripts/arm_master_main.py">light.launch</a>, <a class="reference external" href="https://github.com/de3-robo/arm_master/blob/master/scripts/arm_master_main.py">panda_one_brick.launch</a>, <a class="reference external" href="https://github.com/de3-robo/arm_master/blob/master/scripts/arm_master_main.py">sim.launch</a> run all necessary ros nodes.
Refer to <strong>Getting Started</strong> for more information on running the code</p>
<p>The <em>scripts</em> are structured such that there is a script which defines the ROS related code, and a script which provides ROS free functions. To illustrate observe the difference between
<code class="docutils literal notranslate"><span class="pre">arm_master_main.py</span></code> and <code class="docutils literal notranslate"><span class="pre">arm_master_functions.py</span></code></p>
</div>
<div class="section" id="main-control-loop">
<h2>Main Control Loop<a class="headerlink" href="#main-control-loop" title="Permalink to this headline">¶</a></h2>
<p>Once running, the Panda arm loops through a control sequence defined in <a class="reference external" href="https://github.com/de3-robo/arm_master/blob/master/scripts/arm_master_main.py">arm_master_main.py</a>,
which calls services and publishes to topics defined in <code class="docutils literal notranslate"><span class="pre">move_arm_server.py</span></code></p>
<p>To understand what is happening in this control sequence, I will go line by line through the important information and explain
the necessary concepts required.</p>
</div>
<div class="section" id="real-panda">
<h2>real_panda<a class="headerlink" href="#real-panda" title="Permalink to this headline">¶</a></h2>
<p>At the start of the runnable code, a variable <code class="docutils literal notranslate"><span class="pre">real_panda</span></code> is defined:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ----------------------------------------------</span>
<span class="n">real_panda</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1"># ----------------------------------------------</span>
</pre></div>
</div>
<p>It is essential this is set correctly depending on weather you wish to run the code on <em>Gazebo</em> or on the real <em>Franka Panda</em>.</p>
<p>Setting this variable to <code class="docutils literal notranslate"><span class="pre">False</span></code>, ensures that the code doesn’t wait for services from the real robot which will
not appear on the ROS network</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">real_panda</span></code> variable also needs to be set in <a class="reference external" href="https://github.com/de3-robo/arm_master/blob/master/scripts/move_arm_server.py">move_arm_server.py</a></p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>If you find that the code is not running and is getting hanged up at launch time it could be because the arm_master node
is waiting for all the required nodes to be launched. Double check <code class="docutils literal notranslate"><span class="pre">real_panda</span></code> is correctly set.</p>
<p>Note that the code calls <code class="docutils literal notranslate"><span class="pre">rospy.wait_for_service()</span></code> each time it is required to connect to another service
or action client:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">connect_srv</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">msg_type</span><span class="p">):</span>

    <span class="n">rospy</span><span class="o">.</span><span class="n">loginfo</span><span class="p">(</span><span class="s2">&quot;Searching for &quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; .... &quot;</span><span class="p">)</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">srv_wrapper</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">msg_type</span><span class="p">)</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">loginfo</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; CONNECTED&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">srv_wrapper</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="loop">
<h2>Loop<a class="headerlink" href="#loop" title="Permalink to this headline">¶</a></h2>
<p>The main loop has the following structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Continue to loop until you have placed the correct number of bricks</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">rospy</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">():</span>
      <span class="k">if</span> <span class="n">placed</span> <span class="o">&lt;</span> <span class="n">num_bricks</span><span class="p">:</span>

          <span class="c1">#Query Positions</span>
          <span class="n">brick</span> <span class="o">=</span> <span class="n">get_brick_pos</span><span class="p">()</span>
          <span class="n">goal</span> <span class="o">=</span> <span class="n">get_goal_pos</span><span class="p">()</span>

          <span class="c1">#Move towards brick and pick up</span>
          <span class="n">pick_up</span><span class="p">(</span><span class="n">brick</span><span class="p">)</span>

          <span class="c1">#Move from pick up positon to place down position</span>
          <span class="n">move_towards</span><span class="p">(</span><span class="n">brick</span><span class="p">,</span> <span class="n">goal</span><span class="p">)</span>

          <span class="c1">#Place down brick</span>
          <span class="n">place_down</span><span class="p">(</span><span class="n">goal</span><span class="p">)</span>

          <span class="c1"># Increment num of brick placed</span>
          <span class="n">placed</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>If you wish to change how the arm moves, change the order in which the <code class="docutils literal notranslate"><span class="pre">pick_up()</span></code>, <code class="docutils literal notranslate"><span class="pre">place_down()</span></code>, <code class="docutils literal notranslate"><span class="pre">place_down()</span></code>
functions are called. Additional motion functions also available in <code class="docutils literal notranslate"><span class="pre">arm_master_main.py</span></code> are <code class="docutils literal notranslate"><span class="pre">go_to()</span></code> and <code class="docutils literal notranslate"><span class="pre">move_arm_curve()</span></code>. To illustrate,
The main loop for our project implementation was implemented as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="ow">not</span> <span class="n">rospy</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">():</span>  <span class="c1"># Main Control Loop for the arm</span>
       <span class="k">if</span> <span class="n">placed</span> <span class="o">&lt;</span> <span class="n">num_bricks</span><span class="p">:</span>  <span class="c1"># Continue to loop until you have placed the correct number of bricks</span>

           <span class="c1"># Query Positions</span>
           <span class="n">brick</span> <span class="o">=</span> <span class="n">get_brick_pos</span><span class="p">(</span><span class="n">placed</span><span class="p">)</span>
           <span class="n">goal</span> <span class="o">=</span> <span class="n">get_goal_pos</span><span class="p">(</span><span class="n">placed</span><span class="p">)</span>

           <span class="k">if</span> <span class="n">goal</span> <span class="o">==</span> <span class="n">last_goal</span><span class="p">:</span>  <span class="c1"># same as last time, don&#39;t go back</span>
               <span class="k">continue</span>
           <span class="n">home</span> <span class="o">=</span> <span class="n">get_home_pos</span><span class="p">()</span>
           <span class="n">over_head</span> <span class="o">=</span> <span class="n">get_over_pos</span><span class="p">()</span>

           <span class="k">if</span> <span class="ow">not</span> <span class="n">real_panda</span><span class="p">:</span>
               <span class="n">gen_brick</span><span class="p">()</span>
           <span class="n">succ</span> <span class="o">=</span> <span class="n">move_towards</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="n">brick</span><span class="p">,</span> <span class="n">circle_points</span><span class="p">)</span>

           <span class="c1"># Pick Place operation then return home</span>

           <span class="n">pick_up</span><span class="p">(</span><span class="n">brick</span><span class="p">)</span>
           <span class="n">succ</span> <span class="o">=</span> <span class="n">move_towards</span><span class="p">(</span><span class="n">brick</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">circle_points</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

           <span class="k">if</span> <span class="ow">not</span> <span class="n">real_panda</span><span class="p">:</span> <span class="c1">#Functionality to return to brick location if you dropped it.</span>
               <span class="k">if</span> <span class="ow">not</span> <span class="n">succ</span><span class="p">:</span>
                   <span class="n">brick_via</span> <span class="o">=</span> <span class="n">brick</span>
                   <span class="n">brick_via</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.2</span>
                   <span class="n">go_to</span><span class="p">(</span><span class="n">brick_via</span><span class="p">)</span>
                   <span class="k">continue</span> <span class="c1">#continue, don&#39;t increment placed</span>

           <span class="n">place_down</span><span class="p">(</span><span class="n">goal</span><span class="p">)</span>

           <span class="n">succ</span> <span class="o">=</span> <span class="n">move_towards</span><span class="p">(</span><span class="n">goal</span><span class="p">,</span> <span class="n">home</span><span class="p">,</span> <span class="n">circle_points</span><span class="p">)</span>
           <span class="n">placed</span> <span class="o">+=</span> <span class="mi">1</span>
           <span class="n">last_goal</span> <span class="o">=</span> <span class="n">goal</span>  <span class="c1"># placed down now its a last brick</span>

           <span class="n">rospy</span><span class="o">.</span><span class="n">loginfo</span><span class="p">(</span><span class="s2">&quot;Placed&quot;</span><span class="p">)</span>
           <span class="c1"># Place another brick from stack onto wall</span>

       <span class="k">else</span><span class="p">:</span>  <span class="c1"># When done just wait</span>
           <span class="n">rospy</span><span class="o">.</span><span class="n">loginfo</span><span class="p">(</span><span class="s2">&quot;Done, &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">placed</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; bricks placed&quot;</span><span class="p">)</span>
       <span class="n">rate</span><span class="o">.</span><span class="n">sleep</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="behind-the-scenes">
<h2>Behind the Scenes<a class="headerlink" href="#behind-the-scenes" title="Permalink to this headline">¶</a></h2>
<p>I will now explain more of the theoretical aspects of what happens when a motion function like <code class="docutils literal notranslate"><span class="pre">pick_up()</span></code> is called in
<code class="docutils literal notranslate"><span class="pre">arm_master_main.py</span></code>.</p>
<div class="section" id="pick-up">
<h3>Pick Up<a class="headerlink" href="#pick-up" title="Permalink to this headline">¶</a></h3>
<p>The pick up function in full is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pick_up</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">via_offset</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>

    <span class="k">global</span> <span class="n">holding_brick</span>  <span class="c1"># use global var</span>

    <span class="c1"># First Move to point above the pick up location</span>
    <span class="n">via_point</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
    <span class="n">via_point</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">via_offset</span>  <span class="c1"># Z offset</span>

    <span class="n">move_arm</span><span class="p">(</span><span class="n">via_point</span><span class="p">)</span>  <span class="c1"># Move arm to just above goal</span>
    <span class="n">move_arm</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>  <span class="c1"># Lower arm down to goal</span>
    <span class="c1"># rospy.sleep(0.5) # Play with timming in here to get desired behaviour</span>
    <span class="n">close_gripper</span><span class="p">()</span>  <span class="c1"># Grasp around brick</span>

    <span class="n">holding_brick</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">move_arm</span><span class="p">(</span><span class="n">via_point</span><span class="p">)</span>  <span class="c1"># Move back to via point</span>

    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
<p>It is queried using a target end effector position, set to the location and rotation of the brick to be picked up (defined by a
<code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">y,</span> <span class="pre">z,</span> <span class="pre">rot_x,</span> <span class="pre">rot_y,</span> <span class="pre">rot_z]</span></code> list). The second <code class="docutils literal notranslate"><span class="pre">via_offset</span></code> parameter determines how high the above the brick the end effector will first travel before
lowering and picking up the brick.</p>
<p>Pictorially the function <code class="docutils literal notranslate"><span class="pre">pick_up()</span></code> looks like:</p>
<div class="figure align-center">
<img alt="_images/pick_up.jpg" src="_images/pick_up.jpg" />
</div>
<p>Going line by line, first <code class="docutils literal notranslate"><span class="pre">move_arm(via_point)</span></code> is called. This calls the function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">move_arm</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>

<span class="n">msg</span> <span class="o">=</span> <span class="n">MoveArm</span><span class="p">()</span>
<span class="n">rospy</span><span class="o">.</span><span class="n">loginfo</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
<span class="n">success</span> <span class="o">=</span> <span class="n">move_arm_wrapper</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">z</span><span class="o">=</span><span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">rot_x</span><span class="o">=</span><span class="n">pos</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">rot_y</span><span class="o">=</span><span class="n">pos</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">rot_z</span><span class="o">=</span><span class="n">pos</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>

<span class="k">return</span> <span class="n">success</span>
</pre></div>
</div>
<p>Which further provides a wrapper to the service <cite>move_arm</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">move_arm_wrapper</span> <span class="o">=</span> <span class="n">connect_srv</span><span class="p">(</span><span class="s1">&#39;move_arm&#39;</span><span class="p">,</span> <span class="n">MoveArm</span><span class="p">)</span>
</pre></div>
</div>
<p>All arm moment services are defined in ROS node initialized in <code class="docutils literal notranslate"><span class="pre">move_arm_server.py</span></code>. When a request is sent to the <code class="docutils literal notranslate"><span class="pre">move_arm</span></code> service,
the <code class="docutils literal notranslate"><span class="pre">move_arm_handler(req)</span></code> function defined inside <code class="docutils literal notranslate"><span class="pre">move_arm_server.py</span></code> is called:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">move_arm_handler</span><span class="p">(</span><span class="n">req</span><span class="p">):</span>

    <span class="n">goal</span> <span class="o">=</span> <span class="p">[</span><span class="n">req</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">req</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">req</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">req</span><span class="o">.</span><span class="n">rot_x</span><span class="p">,</span><span class="n">req</span><span class="o">.</span><span class="n">rot_y</span><span class="p">,</span><span class="n">req</span><span class="o">.</span><span class="n">rot_z</span><span class="p">]</span>
    <span class="c1"># goal = [0.5,-0.5,0.5,0,3.14,0]</span>

    <span class="n">group</span><span class="o">.</span><span class="n">set_goal_position_tolerance</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
    <span class="n">group</span><span class="o">.</span><span class="n">set_goal_orientation_tolerance</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>

    <span class="n">via_points</span> <span class="o">=</span> <span class="n">plan_cartesian_path</span><span class="p">(</span><span class="n">goal</span><span class="p">,</span><span class="n">resolution</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#res can be changed</span>

    <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">via_points</span><span class="p">:</span>
        <span class="n">plan</span> <span class="o">=</span> <span class="n">move_arm_a_to_b</span><span class="p">(</span><span class="n">point</span><span class="p">)</span> <span class="c1">#</span>
        <span class="c1">#Publish this plan at my own speed</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">real_panda</span><span class="p">:</span>
            <span class="n">group</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">plan</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EXECUTING PLAN&quot;</span><span class="p">)</span>

            <span class="n">execute</span><span class="p">(</span><span class="n">plan</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1">#Running on real panada</span>
            <span class="c1"># plan = slow_down(plan)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EXECUTING PLAN ON REAL ROBOT&quot;</span><span class="p">)</span>

            <span class="n">group</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">plan</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">group</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="n">group</span><span class="o">.</span><span class="n">clear_pose_targets</span><span class="p">()</span>

    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
<p>Depending on whether your running on the real robot or <em>Gazebo</em>, how the plan is executed changes, but the fundamental planning of the path doesn’t.</p>
<p>First a set of end_effector via_points are determined between the current robot position and the goal position. This is done by calling
`` plan_cartesian_path()`` which then calls <code class="docutils literal notranslate"><span class="pre">get_via_points()</span></code>. <code class="docutils literal notranslate"><span class="pre">get_via_points()</span></code> is a function
defined in the <code class="docutils literal notranslate"><span class="pre">arm_server_functions.py</span></code> file. <code class="docutils literal notranslate"><span class="pre">get_via_points()</span></code> essentially determines the displacement vector between the start and goal
position and then samples points along the same direction incrementally at a set resolution. Pictorially the operation is as follows:</p>
<div class="figure align-center">
<img alt="_images/get_via_points.jpg" src="_images/get_via_points.jpg" />
</div>
<p>While much of this sampling computation can be accomplished using the the <code class="docutils literal notranslate"><span class="pre">compute_cartesian_path()</span></code> function, <code class="docutils literal notranslate"><span class="pre">get_via_points()</span></code> gives up additional flexibility and control over the position
of way points, and is used to break up the movement into smaller chunks. Once the <code class="docutils literal notranslate"><span class="pre">via_points</span></code> have been obtained, the next step is to create a robot trajectory which goes through all the points.
This is done using the <code class="docutils literal notranslate"><span class="pre">move_arm_a_to_b()</span></code> function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">move_arm_a_to_b</span><span class="p">(</span><span class="n">goal</span><span class="p">):</span> <span class="c1">#move very short distance</span>


    <span class="n">rospy</span><span class="o">.</span><span class="n">loginfo</span><span class="p">(</span><span class="s1">&#39;goal&#39;</span><span class="p">)</span>

    <span class="n">waypoints</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">wpose</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">get_current_pose</span><span class="p">()</span><span class="o">.</span><span class="n">pose</span>
    <span class="n">wpose</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="mf">0.0001</span>
    <span class="n">waypoints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">wpose</span><span class="p">))</span>
    <span class="n">wpose</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">goal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">wpose</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">goal</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># First move up (z)</span>
    <span class="n">wpose</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">goal</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># and sideways (y)</span>
    <span class="n">quaternion</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">transformations</span><span class="o">.</span><span class="n">quaternion_from_euler</span><span class="p">(</span><span class="n">goal</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">goal</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">goal</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="c1">#(roll, pitch, yaw)</span>
    <span class="n">wpose</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">quaternion</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">wpose</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">quaternion</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">wpose</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">quaternion</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">wpose</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">quaternion</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">waypoints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">wpose</span><span class="p">))</span>

    <span class="n">group</span><span class="o">.</span><span class="n">set_planning_time</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="p">(</span><span class="n">plan</span><span class="p">,</span> <span class="n">fraction</span><span class="p">)</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">compute_cartesian_path</span><span class="p">(</span>
                                       <span class="n">waypoints</span><span class="p">,</span>   <span class="c1"># waypoints to follow</span>
                                       <span class="mf">0.02</span><span class="p">,</span>        <span class="c1"># eef_step</span>
                                       <span class="mi">2</span><span class="p">)</span>         <span class="c1"># jump_threshold</span>
    <span class="c1"># rospy.loginfo(goal)</span>

    <span class="k">return</span> <span class="n">plan</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">move_arm_a_to_b()</span></code> function utilises <em>MoveIt</em> to solve IK along the desired path. First it gets the current position of the robot from the move group interface:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wpose</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">get_current_pose</span><span class="p">()</span><span class="o">.</span><span class="n">pose</span>
</pre></div>
</div>
<p>It then reads the desired end effector position, passed in as <code class="docutils literal notranslate"><span class="pre">goal</span></code>, which is defined with euler angles (<code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">y,</span> <span class="pre">z,</span> <span class="pre">roll,</span> <span class="pre">pitch,</span> <span class="pre">yaw]</span></code>), and changes it to a quaternion representation
(<code class="docutils literal notranslate"><span class="pre">[x,</span> <span class="pre">y,</span> <span class="pre">z,</span> <span class="pre">X,</span> <span class="pre">Y,</span> <span class="pre">Z,</span> <span class="pre">W]</span></code>). The quaternion representation is equivalent to the euler angles, but rather then represent a rotation with 3 separate rotations around
linearly independent axis, a 4D vector is used. This 4D vector has advantages in that it doesn’t degenerate and reach singularities in certain rotation sequences, and
thus can be seen as more general. That said, it is not intuitive to work with quaternion’s. All poses in our code-base are encoded with the Euler description and transformed to
a quaternion at the last moment using the <code class="docutils literal notranslate"><span class="pre">tf.transformations</span></code> function.</p>
<p>Now that the goal pose is described in the same vector space as the current position (7D vector), a linear interpolation can be calculated between the two. For this purpose,
the <code class="docutils literal notranslate"><span class="pre">compute_cartesian_path</span></code> function is used. This function first samples points along the straight line between the waypoints, the distance between the points is given by the
<code class="docutils literal notranslate"><span class="pre">eef_step</span></code> parameter. It then solves IK for each of those sampled points. As the robot is redundant (7 DOF for a task which requires at most 6 DOF), it is able to find many solutions to
the IK problem. Mathematically this means that that null space of the Jacobean contains vectors other than the zero vector. Redundancy resolution is specified such that IK solution minimises the distance from the
previous solution. Specifically we specify in the <code class="docutils literal notranslate"><span class="pre">jump_threshold</span></code> parameter that the difference in joint angles in neighbouring IK solutions can be no greater than 2 radians.</p>
<p>The resulting output is a series of joint angles which describe an arm trajectory along the line between the current and goal position.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Because we always specify the end effector of the robot to be pointing downwards, it remains pointing downwards during the interpolation between the current and
goal position. Just the x, y, z position of the end effector changes.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All poses are taken with respect to a static world frame located at the base of the Randa robot</p>
</div>
<p>Focusing back on the <code class="docutils literal notranslate"><span class="pre">move_arm_handler(req)</span></code> function. The next step is to execute that path. Regardless of whether the robot is running on <em>Gazebo</em> or on the real robot,
the desired joint angles are used to update the set point on the robot’s PID controller. This results in a error between current and desired joint angles,
which results in a proportional gain to be applied to the motors, which ultimately moves the arm. Sending all the joint angles in
succession and the arm will track the desired end effector movement. Key parameters here are the frequency at which the joint angles are published and the distance between the joint angles.
As only a feedback is being used to control the robot, extremely large steps in joint angles will lead to un unnatural arm behaviour.</p>
<p>This summarizes the main computation and considerations behind moving the Panda arm. We now focus back on the <code class="docutils literal notranslate"><span class="pre">pick_up()</span></code> function. You will see that picking up the brick is simply
a matter of asking the robot arm to move first from its current position to a via point - a set z-offset above the brick. Then to lower down to just above the brick,
close the gripper around the brick, and finally return to the via point. Each time, the motion happens as in the paragraphs described above.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">While there are slight differences between controlling the gripper in <em>Gazebo</em> vs on the real robot, the essence is to publish
a desired gripper width to a topic that is being read by a controller on the Franka gripper.</p>
</div>
</div>
<div class="section" id="move-towards">
<h3>Move towards<a class="headerlink" href="#move-towards" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">move_towards()</span></code> is the other main motion function called in <code class="docutils literal notranslate"><span class="pre">arm_master_main.py</span></code>. The mechanics through which the arm moves are identical to the process described in the paragraphs above. After a few layers of functions,
it calls the exact same <code class="docutils literal notranslate"><span class="pre">move_arm()</span></code> function. The difference in <code class="docutils literal notranslate"><span class="pre">move_towards()</span></code> is how the way way points are selected.
Pictorially what happens when you call the function is as follows:</p>
<div class="figure align-center">
<img alt="_images/move_towards.jpg" src="_images/move_towards.jpg" />
</div>
<p>Stepping through the function line by line, you will see exactly how this behaviour is implemented. First the closest points on the circle
to the goal and start location are determined. These will become the entry and exit points to the circle:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">move_towards</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">round_way_points</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="c1"># find nearest point to pick</span>
    <span class="n">min_start_dist</span> <span class="o">=</span> <span class="mi">10000</span>
    <span class="n">min_start_ind</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">min_end_dist</span> <span class="o">=</span> <span class="mi">10000</span>
    <span class="n">min_end_ind</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">round_way_points</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># print(key, value)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dist_start</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">dist_end</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">end</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dist_start</span> <span class="o">&lt;</span> <span class="n">min_start_dist</span><span class="p">:</span>
            <span class="n">min_start_dist</span> <span class="o">=</span> <span class="n">dist_start</span>
            <span class="n">min_start_ind</span> <span class="o">=</span> <span class="n">key</span>

        <span class="k">if</span> <span class="n">dist_end</span> <span class="o">&lt;</span> <span class="n">min_end_dist</span><span class="p">:</span>
            <span class="n">min_end_dist</span> <span class="o">=</span> <span class="n">dist_end</span>
            <span class="n">min_end_ind</span> <span class="o">=</span> <span class="n">key</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<p>The circle points are generated by a function <code class="docutils literal notranslate"><span class="pre">get_round_points()</span></code> in <code class="docutils literal notranslate"><span class="pre">arm_master_functions.py</span></code>. By changing the <code class="docutils literal notranslate"><span class="pre">res</span></code>,
<code class="docutils literal notranslate"><span class="pre">diameter</span></code>, <code class="docutils literal notranslate"><span class="pre">height</span></code>, <code class="docutils literal notranslate"><span class="pre">x_thresh</span></code> the nature of the circle can be changed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_round_points</span><span class="p">():</span>

    <span class="n">round_path</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">diameter</span> <span class="o">=</span> <span class="mf">1.25</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">diameter</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># diameter of the circle</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># height of the circle</span>

    <span class="n">x_c</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">y_c</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">res</span><span class="p">)</span>
        <span class="n">right</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="n">get_LR_ind</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">neighbour</span> <span class="o">=</span> <span class="p">[</span><span class="n">right</span><span class="p">,</span> <span class="n">left</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x_c</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y_c</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_c</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">y_c</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">height</span><span class="p">]</span>
        <span class="n">round_path</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">pos</span><span class="p">,</span> <span class="n">neighbour</span><span class="p">]</span>

    <span class="n">x_thresh</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span>  <span class="c1"># x threshold behind the arm</span>

    <span class="c1"># remove illegal points</span>
    <span class="n">to_remove</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">round_path</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">x_thresh</span><span class="p">:</span>
            <span class="n">r_i</span><span class="p">,</span> <span class="n">l_i</span> <span class="o">=</span> <span class="n">get_LR_ind</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

            <span class="c1"># go to thoose values and delete your self</span>
            <span class="n">right_neighbour_list</span> <span class="o">=</span> <span class="n">round_path</span><span class="p">[</span><span class="n">r_i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">left_neighbour_list</span> <span class="o">=</span> <span class="n">round_path</span><span class="p">[</span><span class="n">l_i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">right_neighbour_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">left_neighbour_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">to_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">to_remove</span><span class="p">:</span>
        <span class="c1"># print(i)</span>
        <span class="k">del</span> <span class="n">round_path</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">round_path</span>
</pre></div>
</div>
<p>Back in <code class="docutils literal notranslate"><span class="pre">move_towards()</span></code>, once the starting point is determined, one must then decide whether to go left or right around the circle. This calculation is done by the <code class="docutils literal notranslate"><span class="pre">left_or_right()</span></code> function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curr_ind</span> <span class="o">=</span> <span class="n">min_start_ind</span>

<span class="n">selector</span> <span class="o">=</span> <span class="n">left_or_right</span><span class="p">(</span><span class="n">curr_ind</span><span class="p">,</span> <span class="n">min_end_ind</span><span class="p">,</span> <span class="n">round_way_points</span><span class="p">)</span>


<span class="k">while</span> <span class="n">curr_ind</span> <span class="o">!=</span> <span class="n">min_end_ind</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">check</span><span class="p">:</span>  <span class="c1"># Check if dropped</span>
        <span class="n">rospy</span><span class="o">.</span><span class="n">loginfo</span><span class="p">(</span><span class="s2">&quot;CHECKING IF DROPPED&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">check_dropped</span><span class="p">():</span>  <span class="c1"># Exit and return failure</span>
            <span class="n">rospy</span><span class="o">.</span><span class="n">loginfo</span><span class="p">(</span><span class="s2">&quot;DROPPED BRICK!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># move arm to the curr node positon</span>
    <span class="n">curr_node</span> <span class="o">=</span> <span class="n">round_way_points</span><span class="p">[</span><span class="n">curr_ind</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MOVING ARM&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CURR NODE Z: &quot;</span><span class="p">,</span> <span class="n">curr_node</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Finally the arm is moved to the neighbour way point in the circle until it reachs the way point with the exit id calculated at the begging of the function call. As you can see, the same <code class="docutils literal notranslate"><span class="pre">move_arm()</span></code> function
is used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">move_arm</span><span class="p">([</span><span class="n">curr_node</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">curr_node</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">curr_node</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">3.14</span> <span class="o">/</span> <span class="mi">4</span><span class="p">])</span>
    <span class="n">curr_ind</span> <span class="o">=</span> <span class="n">curr_node</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">selector</span><span class="p">]</span>  <span class="c1"># go one way around the circle</span>
<span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="spawn_doc.html" class="btn btn-neutral float-right" title="Spawn Manager Package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="getting_start.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Zachary Yamaoka

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>